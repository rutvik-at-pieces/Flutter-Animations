import 'dart:convert';
import 'dart:typed_data';

import 'dart:ui';

import 'package:umbra_flutter/umbra_flutter.dart';

/// {@template hello_world}
/// A Dart Shader class for the `hello_world` shader.
/// {@endtemplate}
class HelloWorld extends UmbraShader {
  HelloWorld._() : super(_cachedProgram!);

  /// {@macro hello_world}
  static Future<HelloWorld> compile() async {
    // Caching the program on the first compile call.
    _cachedProgram ??= await FragmentProgram.compile(
      spirv: Uint8List.fromList(base64Decode(_spirv)).buffer,
    );

    return HelloWorld._();
  }

  static FragmentProgram? _cachedProgram;

  Shader shader({
    required Size resolution,
    required double uTime,
  }) {
    return program.shader(
      floatUniforms: Float32List.fromList([
        uTime,
        resolution.width,
        resolution.height,
      ]),
      samplerUniforms: [],
    );
  }
}

const _spirv =
    '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';
